{% extends 'base.html' %}

{% load static%}

{% load crispy_forms_tags %}

{% block content %}

  <h1 class="title">This is what people are saying about us</h1>
  {% if user.is_authenticated %}
    <p class="leave-review"><a class="menu-btn" href="{% url 'create_review' %}">Leave a Review</a></p>
  {% else %}
    <p class="leave-review"><a class="menu-btn" href="{% url 'account_signup' %}">Leave a Review</a></p>
  {% endif %}
  
  {% if request.user.is_superuser %}
  <!-- Only superusers can view things in here -->
  <p class="leave-review"><a class="menu-btn" href="{% url 'manage_review' %}">Approve Review</a></p>
  {% endif %}

{% for review in review_list %}

<div class="card mb-0 col-8 review">
    <div class="row g-0">
      <div class="col-md-4">
         <!-- The image URL goes in the src attribute -->
         {% if "review_placeholder" in review.image.url %}
         <img src="../../../static/images/placeholder.jpeg" width="100%">
         {% else %}
         <img src=" {{ review.image.url }} " width="100%">
         {% endif %}
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <h5 class="card-title">{{ review.title }}</h5>
          <p class="card-text">{{ review.body }}</p>
          <p class="card-text"><small class="text-muted">{{ review.author }} | {{ review.created_on }}</small></p>
          {%if review.author == request.user%}
            {% if request.user.is_superuser %}
              <a class="menu-btn">Reject Review</a>
            {%endif%}
            <a href="{% url 'update_review' review.id %}" class="menu-btn">Update Review</a>
            <a href="{% url 'delete_review' review.id %}" class="menu-btn">Delete Review</a>
          {%endif%}
        </div>
      </div>
    </div>
  </div>

{% endfor %}

{% if user.is_authenticated %}
  <p class="leave-review"><a class="menu-btn" href="{% url 'create_review' %}">Leave a Review</a></p>
{% else %}
  <p class="leave-review"><a class="menu-btn" href="{% url 'account_signup' %}">Leave a Review</a></p>
{% endif %}

<!-- {% if reviewed %}
  <div class="alert alert-success" role="alert">
      Your comment is awaiting approval
  </div>
  {% else %}
  {% if user.is_authenticated %}
    <h3>Leave a Review:</h3>
    <p id="reviewer">Posting as: {{ user.username }}</p>
    <form method="post" class="review-form">
        {{ review_form.as_p }}
        {% csrf_token %}
        <button type="submit" class="menu-btn">Submit</button>
    </form>
   
  {% endif %}
{% endif %} -->


{% endblock %}